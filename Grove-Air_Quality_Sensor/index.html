<html><head><meta name="viewport" content="width=device-width, initial-scale=1"><link href=//fonts.googleapis.com/css?family=Raleway:400,300,600 rel=stylesheet type=text/css><link rel="stylesheet" type="text/css" href="../common/css/normalize.css"><link rel="stylesheet" type="text/css" href="../common/css/skeleton.css"><link rel="stylesheet" type="text/css" href="../common/css/wiki.css"><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><title>Grove - Air Quality Sensor</title><meta charset="utf-8"/><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-84386732-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body><div class"container"><a href="../"><img src="../common/logo.png"/></a></div><div class="mw-content-ltr container" dir="ltr" id="mw-content-text" lang="en"><h1>Grove - Air Quality Sensor</h1><div class="thumb tright"><div class="thumbinner" style="width:502px;"><a href="http://www.seeedstudio.com/depot/grove-air-quality-sensor-10-p-1065.html"><img src="img/Grove-Air_quality_sensor.jpg" width="500"/></a> <div class="thumbcaption"></div></div></div>
<p>This sensor is designed for comprehensive monitor over indoor air condition. It's responsive to a wide scope of harmful gases, as carbon monoxide, alcohol, acetone, thinner, formaldehyde and so on. Due to the measuring mechanism, this sensor can not output specific data to describe target gases' concentrations quantitatively. But it's still competent enough to be used in applications that require only qualitative results, like auto refresher sprayers and auto air cycling systems.
</p><p><br/>
<a href="http://www.seeedstudio.com/depot/grove-air-quality-sensor-10-p-1065.html"><img src="../common/Get_One_Now_Banner.png" width="300"/></a>
</p><p><br/>
</p>
<p><br/>
</p>
<h2> Features </h2>
<ul><li>Responsive to a wide scope of target gases 
</li><li>Cost efficient 
</li><li>Durable
</li></ul>
<h2> Cautions </h2>
<ul><li>Require relatively clean air as an initial condition. 
</li><li>Long time exposure to highly polluted air can significantly weaken its sensitivity.<br/>
</li></ul>
<h2> Getting Started</h2>
<h3> With <a href="/w/index.php?title=Arduino&amp;action=edit&amp;redlink=1" title="Arduino (page does not exist)">Arduino</a></h3>
<p>As described in Introduction, this sensor does better in providing qualitative results over a wide scope of target gases. In this demo, we define 4 statuses for reference in the .cpp file. They are: 
</p>
<dl><dd>a. air fresh -- indicating a good air condition
</dd></dl>
<dl><dd>b. low pollution -- indicating a rather low concentration of target gases exist.
</dd></dl>
<dl><dd>c. high pollution(without "Force signal active" message printed on serial monitor) -- you should be aware of the pollution level and think if some measures should be taken.
</dd></dl>
<dl><dd>d. high pollution(with "Force signal active" message printed on serial monitor) -- instant measures should be taken to improve the air quality.
</dd></dl>
<p>We encapsulated the judge structure in .cpp file. You can find your way to modify the thresholds in it. 
</p><p>Let's start to try it out! 
</p><p><br/>
</p><p>1. Connect the Sensor to A0 port of <a href="/Grove-Base_Shield" title="Grove - Base Shield">Grove - Base Shield</a>.
</p><p><img src="img/Air_Quality_Sensor_Connector.jpg" width="680"/>
</p><p>2. Download the <a href="res/AirQuality_Sensor.zip">File:AirQuality_Sensor Library</a>.
</p><p>3. Wait 2 min for heat-up of the sensor. Then open the example below by the path:File -&gt; Example -&gt;AirQuality_Sensor-&gt;AirQuality_Sensor. 
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="coMULTI">/*
AirQuality Demo V1.0.
connect to A1 to start testing. it will needs about 20s to start
* By: http://www.seeedstudio.com
*/</span>
<span class="co2">#include "AirQuality.h"</span>
<span class="co2">#include "Arduino.h"</span>
AirQuality airqualitysensor<span class="sy4">;</span>
<span class="kw4">int</span> current_quality <span class="sy1">=</span><span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span>
    airqualitysensor.<span class="kw3">init</span><span class="br0">(</span><span class="nu0">14</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    current_quality<span class="sy1">=</span>airqualitysensor.<span class="me1">slope</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">if</span> <span class="br0">(</span>current_quality <span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="sy1">=</span> <span class="nu0">0</span><span class="br0">)</span><span class="co1">// if a valid data returned.</span>
    <span class="br0">{</span>
        <span class="kw1">if</span> <span class="br0">(</span>current_quality<span class="sy1">==</span><span class="nu0">0</span><span class="br0">)</span>
        <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"High pollution! Force signal active"</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>current_quality<span class="sy1">==</span><span class="nu0">1</span><span class="br0">)</span>
        <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"High pollution!"</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>current_quality<span class="sy1">==</span><span class="nu0">2</span><span class="br0">)</span>
        <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Low pollution!"</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">(</span>current_quality <span class="sy1">==</span><span class="nu0">3</span><span class="br0">)</span>
        <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Fresh air"</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span>
<span class="br0">}</span>
ISR<span class="br0">(</span>TIMER2_OVF_vect<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">if</span><span class="br0">(</span>airqualitysensor.<span class="me1">counter</span><span class="sy1">==</span><span class="nu0">122</span><span class="br0">)</span><span class="co1">//set 2 seconds as a detected duty</span>
    <span class="br0">{</span>
 
        airqualitysensor.<span class="me1">last_vol</span><span class="sy1">=</span>airqualitysensor.<span class="me1">first_vol</span><span class="sy4">;</span>
        airqualitysensor.<span class="me1">first_vol</span><span class="sy1">=</span><span class="kw3">analogRead</span><span class="br0">(</span>A0<span class="br0">)</span><span class="sy4">;</span>
        airqualitysensor.<span class="me1">counter</span><span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span>
        airqualitysensor.<span class="me1">timer_index</span><span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span>
        PORTB<span class="sy1">=</span>PORTB<span class="sy3">^</span><span class="nu12">0x20</span><span class="sy4">;</span>
    <span class="br0">}</span>
    <span class="kw1">else</span>
    <span class="br0">{</span>
        airqualitysensor.<span class="me1">counter</span><span class="sy2">++</span><span class="sy4">;</span>
    <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>4. Upload the code. Please click <a href="/Upload_Code">here</a> if you do not know how to upload it.
</p><p>5. Open serial monitor. 
</p><p><img src="img/Air_Quility_Sensor1.jpg" width="319"/><br/>
</p><p>To adjust the thresholds and indicating messages, refer the judge structure below in .cpp file.<br/>
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="kw4">int</span> AirQuality<span class="sy4">::</span><span class="me2">slope</span><span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">while</span><span class="br0">(</span>timer_index<span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw1">if</span><span class="br0">(</span>first_vol<span class="sy2">-</span>last_vol<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">400</span><span class="sy3">||</span>first_vol<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">700</span><span class="br0">)</span>
        <span class="br0">{</span>
            <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"High pollution! Force signal active."</span><span class="br0">)</span><span class="sy4">;</span>
            timer_index<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span>
            avg_voltage<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">return</span> <span class="nu0">0</span><span class="sy4">;</span>
 
        <span class="br0">}</span>
        <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">(</span><span class="br0">(</span>first_vol<span class="sy2">-</span>last_vol<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">400</span><span class="sy3">&amp;</span>amp<span class="sy4">;</span><span class="sy3">&amp;</span>amp<span class="sy4">;</span>first_vol<span class="sy3">&amp;</span>lt<span class="sy4">;</span><span class="nu0">700</span><span class="br0">)</span><span class="sy3">||</span>first_vol<span class="sy2">-</span>vol_standard<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">150</span><span class="br0">)</span>
        <span class="br0">{</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"sensor_value:"</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span>first_vol<span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"<span class="es1">\t</span> High pollution!"</span><span class="br0">)</span><span class="sy4">;</span>
            timer_index<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span>
            avg_voltage<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">return</span> <span class="nu0">1</span><span class="sy4">;</span>
 
        <span class="br0">}</span>
        <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">(</span><span class="br0">(</span>first_vol<span class="sy2">-</span>last_vol<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">200</span><span class="sy3">&amp;</span>amp<span class="sy4">;</span><span class="sy3">&amp;</span>amp<span class="sy4">;</span>first_vol<span class="sy3">&amp;</span>lt<span class="sy4">;</span><span class="nu0">700</span><span class="br0">)</span><span class="sy3">||</span>first_vol<span class="sy2">-</span>vol_standard<span class="sy3">&amp;</span>gt<span class="sy4">;</span><span class="nu0">50</span><span class="br0">)</span>
        <span class="br0">{</span>
            <span class="co1">//Serial.println(first_vol-last_vol);</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"sensor_value:"</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span>first_vol<span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"<span class="es1">\t</span> Low pollution!"</span><span class="br0">)</span><span class="sy4">;</span>
            timer_index<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span>
            avg_voltage<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">return</span> <span class="nu0">2</span><span class="sy4">;</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
            avg_voltage<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"sensor_value:"</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span>first_vol<span class="br0">)</span><span class="sy4">;</span>
            <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"<span class="es1">\t</span> Air fresh"</span><span class="br0">)</span><span class="sy4">;</span>
            timer_index<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span>
            <span class="kw1">return</span> <span class="nu0">3</span><span class="sy4">;</span>
        <span class="br0">}</span>
    <span class="br0">}</span>
    <span class="kw1">return</span> <span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
<span class="br0">}</span></pre></div></div>
<h3>  With <a href="/GrovePiPlus" title="GrovePi+">Raspberry Pi</a> </h3>
<p>1.You should have got a raspberry pi and a grovepi or grovepi+.<br/>
2.You should have completed configuring the development enviroment, otherwise follow <a href="/GrovePiPlus#Introducing_the_GrovePi.2B">here</a>.
<br/>
3.Connection
<br/>
</p>
<ul><li> Plug the sensor to grovepi socket A0 by using a grove cable.<br/>
</li></ul>
<p>4.Navigate to the demos' directory: <br/>
</p>
<pre>   cd yourpath/GrovePi/Software/Python/
</pre>
<ul><li> To see the code
</li></ul>
<pre>   nano grove_air_quality_sensor.py   # "Ctrl+x" to exit #
</pre>
<pre>
import time
import grovepi

# Connect the Grove Air Quality Sensor to analog port A0
# SIG,NC,VCC,GND
air_sensor = 0

grovepi.pinMode(air_sensor,"INPUT")

while True:
    try:
        # Get sensor value
        sensor_value = grovepi.analogRead(air_sensor)

        if sensor_value &gt; 700:
            print "High pollution"
        elif sensor_value &gt; 300:
            print "Low pollution"
        else:
            print "Air fresh"

        print "sensor_value =", sensor_value
        time.sleep(.5)

    except IOError:
        print "Error"

</pre>
<p>5.Run the demo.<br/>
</p>
<pre>   sudo python grove_air_quality_sensor.py
</pre>
<p><br/>
</p>
<h2> Resources </h2>
<ul><li> <a href="res/AirQuality_Sensor.zip">AirQuality Sensor Library.zip</a>
</li><li> <a href="res/Air_quality_sensor_egale_file.zip" title="File:Air quality sensor egale file.zip">File:Air quality sensor egale file.zip</a>
</li><li> <a href="res/Air_quality_sensor_schematic.pdf" title="File:Air quality sensor schematic.pdf">File:Air quality sensor schematic.pdf</a>
</li><li> <a href="res/TP-401A_Indoor_Air_quality_gas_sensor.pdf" title="File:TP-401A Indoor Air quality gas sensor.pdf">File:TP-401A Indoor Air quality gas sensor.pdf</a>
</li></ul>
<p><br/>
</p>
<h2> Related Projects</h2>
<p>If you want to make some awesome projects by Air Quality Sensor, here are some projects for reference.
</p>
<h3> Air Quality Box 1</h3>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="http://http://www.seeedstudio.com/recipe/35-air-quality-box.html"><img src="img/Overview0.png" width="300"/></a> <div class="thumbcaption"></div></div></div>
<p>With this demo, we can see that:
</p>
<ul><li> All components are packed into the skeleton box
</li><li> The OLED display show message about the air quality
</li><li> Read detailed information about dust, coal gas and formal gas in the house
</li></ul>
<p><a href="http://www.seeedstudio.com/recipe/35-air-quality-box.html"><img src="img/Wiki_makeitnow_logo.png" width="200"/></a>
</p>
<h3> Air Quality Box 2</h3>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="/Link_to_the_demo2" title="Link to the demo2"><img src="img/556bcbf436c49.jpg" width="300"/></a> <div class="thumbcaption"></div></div></div>
<p>With this demo, we can see the air quality data on 4-Digit Display.
</p><p><a href="http://www.seeedstudio.com/recipe/index.php?controller=recipe&amp;action=show&amp;recipe_id=266&amp;ref=product"><img src="img/Wiki_makeitnow_logo.png" width="200"/></a>
</p><p><br/>
</p>
<h2> Help us to make it better </h2>
<p><iframe frameborder="0" height="500" src="https://www.surveymonkey.com/r/GYYNNCJ" width="500"></iframe>
</p>
Copyright (c) 2008-2016 Seeed Development Limited (<a href="http://www.seeedstudio.com">www.seeedstudio.com</a> / <a href="http://www.seeed.cc">www.seeed.cc</a>)<h6>This static html page was created from http://www.seeedstudio.com/wiki</h6></div></body></html>